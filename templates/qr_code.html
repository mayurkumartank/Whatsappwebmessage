<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code Generator</title>
  <!-- Include qrious library -->
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
</head>
<body>
    <h1>Testing qr code</h1>
    <div id="qrcode"></div>
    <div id="qr-container"></div>

    <input type="hidden" name="user_name" id="user_name" value="mayurtank888@gmail.com">


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script>
        let get_user_name = document.getElementById("user_name")
        let formData = new FormData();
        formData.append("user_name", get_user_name.value)
        function getCookie(name) {
            var value = "; " + document.cookie;
            var parts = value.split("; " + name + "=");
            if (parts.length == 2) return parts.pop().split(";").shift();
        }
        fetch('http://localhost:3000/qr/')
            .then((response) => response.text())
            .then((qrCodeHtml) => {
                var qrcodeElement = document.getElementById("qrcode")
                qrcodeElement.innerHTML = qrCodeHtml
                // if (qrCodeHtml === "Timeout: QR code not received in time."){
                //     var qrcodeElement = document.getElementById("qrcode");
                //     var PElement = document.createElement("p");
                //     PElement.innerHTML = qrCodeHtml;
                //     qrcodeElement.appendChild(PElement);
                // }else{
                //     console.log(qrCodeHtml)
                //     const dataRef = qrCodeHtml;
                //     const qr = new QRious({
                //         element: document.getElementById('qr-code'),
                //         value: dataRef,
                //         size: 200, // Adjust the size as needed
                //         level: 'L' // L stands for low error correction level, adjust as needed
                //     });
                //     const qrImage = qr.toDataURL();
                //     console.log(qrImage);
                //     var qrcodeElement = document.getElementById("qrcode");
                //     var imgElement = document.createElement("img");
                //     imgElement.src = qrImage;
                //     qrcodeElement.appendChild(imgElement);
                // }
                
            })
            .catch((error) => console.error('Error fetching QR code:', error));
            
        
        
        // fetch('http://127.0.0.1:8000/api/qrcode/', {
        //     method: 'POST',
        //     body: formData,
        //     headers: {
        //         'X-CSRFToken': getCookie('csrftoken'),
        //     },
        // })
        // .then(response => response.json())
        // .then(data => {
        //     const dataRef = data.message;
        //     const qr = new QRious({
        //         element: document.getElementById('qr-code'),
        //         value: dataRef,
        //         size: 200, // Adjust the size as needed
        //         level: 'L' // L stands for low error correction level, adjust as needed
        //     });
        //     const qrImage = qr.toDataURL();
        //     console.log(qrImage);
        //     var qrcodeElement = document.getElementById("qrcode");
        //     var imgElement = document.createElement("img");
        //     imgElement.src = qrImage;
        //     qrcodeElement.appendChild(imgElement);
        // })
        // .catch(error => {
        //     console.error('Error:', error);
        // }); 

    </script>

</body>
</html>
